class c{config;focusableElements=[];currentFocusIndex=-1;announcer=null;skipLinks=[];highContrastMode=!1;reducedMotionMode=!1;constructor(e={}){this.config={enableKeyboardNavigation:!0,enableScreenReader:!0,enableHighContrast:!0,enableReducedMotion:!0,enableFocusManagement:!0,enableAriaLabels:!0,enableSkipLinks:!0,announcePageChanges:!0,...e}}init(){typeof window>"u"||(this.config.enableKeyboardNavigation&&this.setupKeyboardNavigation(),this.config.enableScreenReader&&this.setupScreenReaderSupport(),this.config.enableHighContrast&&this.setupHighContrastMode(),this.config.enableReducedMotion&&this.setupReducedMotionMode(),this.config.enableFocusManagement&&this.setupFocusManagement(),this.config.enableAriaLabels&&this.setupAriaLabels(),this.config.enableSkipLinks&&this.setupSkipLinks(),this.monitorAccessibilityViolations(),this.logAccessibilityStatus())}setupKeyboardNavigation(){this.updateFocusableElements(),document.addEventListener("keydown",t=>{this.handleKeyboardNavigation(t)}),new MutationObserver(()=>{this.updateFocusableElements()}).observe(document.body,{childList:!0,subtree:!0})}handleKeyboardNavigation(e){switch(e.key){case"Tab":e.shiftKey?this.focusPrevious():this.focusNext();break;case"Escape":this.handleEscape();break;case"Enter":case" ":this.handleActivation(e);break;case"ArrowDown":case"ArrowRight":this.isInMenu()&&(e.preventDefault(),this.focusNext());break;case"ArrowUp":case"ArrowLeft":this.isInMenu()&&(e.preventDefault(),this.focusPrevious());break;case"Home":this.isInMenu()&&(e.preventDefault(),this.focusFirst());break;case"End":this.isInMenu()&&(e.preventDefault(),this.focusLast());break}}updateFocusableElements(){const e=["a[href]","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])",'[tabindex]:not([tabindex="-1"])','[contenteditable="true"]'];this.focusableElements=Array.from(document.querySelectorAll(e.join(", "))).filter(t=>this.isVisible(t)&&!this.isInert(t))}isVisible(e){const t=e.getBoundingClientRect(),i=window.getComputedStyle(e);return t.width>0&&t.height>0&&i.visibility!=="hidden"&&i.display!=="none"&&!e.hidden}isInert(e){return e.hasAttribute("inert")||e.closest("[inert]")!==null}focusNext(){this.currentFocusIndex=(this.currentFocusIndex+1)%this.focusableElements.length,this.focusableElements[this.currentFocusIndex]?.focus()}focusPrevious(){this.currentFocusIndex=this.currentFocusIndex<=0?this.focusableElements.length-1:this.currentFocusIndex-1,this.focusableElements[this.currentFocusIndex]?.focus()}focusFirst(){this.currentFocusIndex=0,this.focusableElements[0]?.focus()}focusLast(){this.currentFocusIndex=this.focusableElements.length-1,this.focusableElements[this.currentFocusIndex]?.focus()}handleEscape(){const e=document.querySelector('[role="dialog"][aria-modal="true"]');if(e){this.closeModal(e);return}const t=document.querySelector('[aria-expanded="true"]');if(t){this.closeDropdown(t);return}const i=document.getElementById("main-content");i&&i.focus()}handleActivation(e){const t=e.target;if(t.tagName==="BUTTON"||t.role==="button")t.click();else if(t.tagName==="A")return}isInMenu(){const e=document.activeElement;return e?.closest('[role="menu"]')!==null||e?.closest('[role="menubar"]')!==null}closeModal(e){e.setAttribute("aria-hidden","true"),e.style.display="none";const t=e.getAttribute("aria-labelledby");t&&document.getElementById(t)?.focus()}closeDropdown(e){e.setAttribute("aria-expanded","false");const t=document.querySelector(`[aria-labelledby="${e.id}"]`);t&&t.setAttribute("aria-hidden","true")}setupScreenReaderSupport(){this.announcer=document.createElement("div"),this.announcer.id="accessibility-announcer",this.announcer.setAttribute("aria-live","polite"),this.announcer.setAttribute("aria-atomic","true"),this.announcer.className="sr-only",document.body.appendChild(this.announcer),this.config.announcePageChanges&&this.setupPageChangeAnnouncements(),this.enhanceDynamicContent()}setupPageChangeAnnouncements(){window.addEventListener("hashchange",()=>{const t=window.location.hash.slice(1);t&&this.announce(`Navigated to ${t} section`)});const e=history.pushState;history.pushState=function(t,i,n){e.call(history,t,i,n),window.dispatchEvent(new CustomEvent("routechange",{detail:{url:n}}))},window.addEventListener("routechange",t=>{const i=t.detail.url;this.announce(`Page changed to ${i}`)})}enhanceDynamicContent(){new MutationObserver(t=>{t.forEach(i=>{i.type==="childList"&&i.addedNodes.length>0&&i.addedNodes.forEach(n=>{n.nodeType===Node.ELEMENT_NODE&&this.enhanceElement(n)})})}).observe(document.body,{childList:!0,subtree:!0})}enhanceElement(e){if(e.tagName==="IMG"&&!e.hasAttribute("alt")&&e.setAttribute("alt","Image"),e.tagName==="BUTTON"&&!e.hasAttribute("aria-label")){const t=e.textContent?.trim();t&&e.setAttribute("aria-label",t)}(e.tagName==="INPUT"||e.tagName==="TEXTAREA")&&this.enhanceFormElement(e)}enhanceFormElement(e){if(!e.hasAttribute("aria-label")&&!e.hasAttribute("aria-labelledby")){const t=document.querySelector(`label[for="${e.id}"]`);t&&e.setAttribute("aria-labelledby",t.id||this.generateId())}e.required&&!e.hasAttribute("aria-required")&&e.setAttribute("aria-required","true"),e.validity&&!e.validity.valid&&e.setAttribute("aria-invalid","true")}setupHighContrastMode(){window.matchMedia("(prefers-contrast: high)").matches&&this.enableHighContrast(),this.createAccessibilityControls()}setupReducedMotionMode(){window.matchMedia("(prefers-reduced-motion: reduce)").matches&&this.enableReducedMotion()}setupFocusManagement(){this.addFocusIndicators(),this.setupFocusTrapping(),this.setupFocusRestoration()}addFocusIndicators(){const e=document.createElement("style");e.textContent=`
      /* Enhanced focus indicators */
      *:focus {
        outline: 2px solid var(--accent-primary);
        outline-offset: 2px;
      }
      
      /* High contrast focus indicators */
      @media (prefers-contrast: high) {
        *:focus {
          outline: 3px solid currentColor;
          outline-offset: 3px;
        }
      }
      
      /* Reduced motion focus indicators */
      @media (prefers-reduced-motion: reduce) {
        *:focus {
          transition: none;
        }
      }
    `,document.head.appendChild(e)}setupFocusTrapping(){document.addEventListener("focusin",e=>{const t=document.querySelector('[role="dialog"][aria-modal="true"]');t&&!t.contains(e.target)&&t.querySelector('[tabindex]:not([tabindex="-1"]), button, input, select, textarea, a[href]')?.focus()})}setupFocusRestoration(){let e=null;document.addEventListener("focusout",t=>{e=t.target}),document.addEventListener("click",t=>{t.target.hasAttribute("data-dismiss")&&setTimeout(()=>{e&&e.focus()},100)})}setupAriaLabels(){this.enhanceExistingElements(),new MutationObserver(t=>{t.forEach(i=>{i.addedNodes.forEach(n=>{n.nodeType===Node.ELEMENT_NODE&&this.enhanceElement(n)})})}).observe(document.body,{childList:!0,subtree:!0})}enhanceExistingElements(){this.addLandmarkRoles(),this.enhanceHeadingStructure(),this.enhanceButtonElements(),this.enhanceFormElements()}addLandmarkRoles(){const e=document.querySelector("main");e&&!e.hasAttribute("role")&&e.setAttribute("role","main");const t=document.querySelector("nav");t&&!t.hasAttribute("role")&&(t.setAttribute("role","navigation"),t.setAttribute("aria-label","Main navigation")),document.querySelectorAll("section").forEach(n=>{if(!n.hasAttribute("role")){n.setAttribute("role","region");const s=n.querySelector("h1, h2, h3, h4, h5, h6");if(s){const o=s.id||this.generateId();s.id=o,n.setAttribute("aria-labelledby",o)}}})}enhanceHeadingStructure(){document.querySelectorAll("h1, h2, h3, h4, h5, h6").forEach(t=>{t.id||(t.id=this.generateId())})}enhanceButtonElements(){document.querySelectorAll('button, [role="button"]').forEach(t=>{if(!t.hasAttribute("aria-label")&&!t.hasAttribute("aria-labelledby")){const i=t.textContent?.trim();i&&t.setAttribute("aria-label",i)}})}enhanceFormElements(){document.querySelectorAll("input, textarea, select").forEach(t=>{this.enhanceFormElement(t)})}setupSkipLinks(){const e=document.createElement("div");e.className="skip-links",e.setAttribute("aria-label","Skip links");const t=this.createSkipLink("Skip to main content","#main-content");e.appendChild(t);const i=this.createSkipLink("Skip to navigation","nav");e.appendChild(i),document.body.insertBefore(e,document.body.firstChild)}createSkipLink(e,t){const i=document.createElement("a");return i.href=t,i.textContent=e,i.className="skip-link",i.addEventListener("click",n=>{n.preventDefault();const s=document.querySelector(t);s&&(s.focus(),s.scrollIntoView({behavior:"smooth"}))}),i}enableHighContrast(){this.highContrastMode=!0,document.body.classList.add("high-contrast"),this.announce("High contrast mode enabled")}disableHighContrast(){this.highContrastMode=!1,document.body.classList.remove("high-contrast"),this.announce("High contrast mode disabled")}enableReducedMotion(){this.reducedMotionMode=!0,document.body.classList.add("reduced-motion"),this.announce("Reduced motion mode enabled")}disableReducedMotion(){this.reducedMotionMode=!1,document.body.classList.remove("reduced-motion"),this.announce("Reduced motion mode disabled")}createAccessibilityControls(){const e=document.createElement("div");e.className="accessibility-controls",e.setAttribute("aria-label","Accessibility controls");const t=document.createElement("button");t.textContent="Toggle High Contrast",t.setAttribute("aria-pressed",this.highContrastMode.toString()),t.addEventListener("click",()=>{this.highContrastMode?this.disableHighContrast():this.enableHighContrast(),t.setAttribute("aria-pressed",this.highContrastMode.toString())}),e.appendChild(t),document.body.appendChild(e)}monitorAccessibilityViolations(){setTimeout(()=>{const e=this.checkAccessibilityViolations();e.length>0&&(console.group("üîç Accessibility Violations"),e.forEach(t=>{const i=t.type==="error"?"‚ùå":t.type==="warning"?"‚ö†Ô∏è":"‚ÑπÔ∏è";console.log(`${i} ${t.message}`),console.log(`   Rule: ${t.rule}`),console.log(`   Element: ${t.element}`),console.log(`   Impact: ${t.impact}`),console.log(`   Solution: ${t.solution}`)}),console.groupEnd())},1e3)}checkAccessibilityViolations(){const e=[];document.querySelectorAll("img:not([alt])").forEach(o=>{e.push({type:"error",rule:"WCAG 1.1.1",element:o.tagName,message:"Image missing alt attribute",impact:"critical",solution:"Add descriptive alt attribute to image"})}),document.querySelectorAll("input:not([aria-label]):not([aria-labelledby])").forEach(o=>{e.push({type:"error",rule:"WCAG 1.3.1",element:o.tagName,message:"Form input missing label",impact:"serious",solution:"Add aria-label or associate with label element"})});const n=document.querySelectorAll("h1, h2, h3, h4, h5, h6");let s=0;return n.forEach(o=>{const a=parseInt(o.tagName.charAt(1));a>s+1&&e.push({type:"warning",rule:"WCAG 1.3.1",element:o.tagName,message:"Heading hierarchy skipped",impact:"moderate",solution:"Use proper heading hierarchy (h1, h2, h3, etc.)"}),s=a}),e}announce(e){this.announcer&&(this.announcer.textContent=e,setTimeout(()=>{this.announcer&&(this.announcer.textContent="")},1e3))}generateId(){return`accessibility-${Math.random().toString(36).substr(2,9)}`}logAccessibilityStatus(){setTimeout(()=>{const e=this.generateAccessibilityReport();console.log("‚ôø Accessibility Report:",e)},2e3)}generateAccessibilityReport(){const e=this.checkAccessibilityViolations(),t=this.generateRecommendations(),i=this.calculateComplianceScore(e),n=this.determineWcagLevel(i);return{violations:e,recommendations:t,complianceScore:i,wcagLevel:n}}generateRecommendations(){const e=[];return document.querySelector('[role="main"]')||e.push({category:"Structure",message:"Add main landmark role",priority:"high",implementation:'Add role="main" to main content area'}),document.querySelector(".skip-links")||e.push({category:"Navigation",message:"Add skip links",priority:"high",implementation:"Add skip links for keyboard navigation"}),e}calculateComplianceScore(e){let t=100;return e.forEach(i=>{switch(i.impact){case"critical":t-=25;break;case"serious":t-=15;break;case"moderate":t-=10;break;case"minor":t-=5;break}}),Math.max(0,t)}determineWcagLevel(e){return e>=95?"AAA":e>=85?"AA":"A"}cleanup(){this.announcer&&(this.announcer.remove(),this.announcer=null),document.removeEventListener("keydown",this.handleKeyboardNavigation)}}export{c as default};
